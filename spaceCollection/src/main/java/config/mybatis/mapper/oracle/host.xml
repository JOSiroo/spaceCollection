<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.sc.spaceCollection.host.model.HostDAO">
	<!-- 카테고리가 메인이고 resultmap에는 메인에 대한걸 작성 
	컬렉션은 select category에서 가져온 categoryno로 type을 조회한다. -->
	
	<select id="selectSpaceType" resultType="SpaceTypeVO" parameterType="int">
		select * from space_type
		where category_no = #{categoryNo}
	</select>
	
	<resultMap type="SpaceCategoryAllVO" id="spaceTypeResultMap">
		<association property="spaceCategoryVo" column="categoryNo" javaType="SpaceCategoryVO" >
			<id property="categoryNo" column="category_no" jdbcType="BIGINT" />
			<result property="categoryName" column="category_name" jdbcType="VARCHAR" />
		</association>
		<collection property="spaceTypeList" javaType="ArrayList" ofType="map" 
			column="category_no" select="selectSpaceType">
		</collection>
	</resultMap>

	<select id="selectSpaceCategory" resultMap="spaceTypeResultMap">
		select * from space_type_category
		order by category_no
	</select>
	
	<select id="selectUserById" resultType="userInfoVo" parameterType="String">
		select * from user_info
		where user_id = #{userId}
	</select>
	
	<select id="selectHostReservation" resultType="map">
		select *
		from
		(
		    select rownum as rn, f.* 
		    from 
		    (
		        select * from host_reservation_view
		        where user_num = #{userNum}
		    )f
		)A
		<![CDATA[ 
		where rn >= #{startRow} and rn <= #{endRow} ]]>
	</select>
	<select id="HostReservationCalendar" resultType="map">
        select * from host_reservation_view
        where user_num = #{userNum}
	</select>
	
</mapper>